# Сценарии использования

## Название варианта использования: Добавление новой задачи.

**Цель:** Позволить пользователю добавить новую домашнюю задачу с возможностью указания приоритета, исполнителя и срока выполнения.

**Актёры:** Администратор.

**Триггер:** Пользователь решает добавить новую задачу в список.

**Предварительные условия:**
- открыто приложение;
- выбран источник хранения (Excel, PostgreSQL, H2)
- все поля формы доступны для редактирования.

**Основной поток выполнения:**
1. Пользователь вводит название и описание задачи.
2. Выбирает приоритет, тип задачи, исполнителя.
3. Устанавливает срок выполнения через DatePicker.
4. Нажимает кнопку «Добавить».
5. Система валидирует обязательные поля (название, срок).
6. Если всё корректно, задача сохраняется в выбранное хранилище.
7. Таблица обновляется, поля очищаются.

**Альтернативы:**

**A1: Ошибка валидации**
1. Пользователь оставляет обязательное поле пустым;
2. Система показывает сообщение об ошибке;
3. Пользователь исправляет ввод и повторяет попытку добавления.

**A2: Ошибка добавления задачи**
1. Пользователь заполняет форму и нажимает кнопку «Добавить».
2. Система пытается сохранить данные, но происходит ошибка (например, нет соединения с базой данных или нарушено ограничение).
3. Система отображает сообщение: «Ошибка добавления: <текст ошибки>»
4. Пользователь анализирует ошибку и пробует повторное добавление задачи.

**Постусловие:**
1. Новая задача появляется в таблице;
2. Интерфейс готов к вводу следующей записи.

## Название варианта использования: Редактирование существующей задачи.

**Цель:** Изменить параметры существующей задачи и сохранить обновление в хранилище.

**Актёры:** Администратор.

**Триггер:** Пользователь выбирает задачу из таблицы для редактирования.

**Предварительные условия:**
- приложение открыто;
- таблица содержит хотя бы одну запись;
- пользователь выбрал запись из таблицы.

**Основной поток выполнения:**
1. Пользователь выбирает задачу в таблице.
2. Поля формы заполняются текущими значениями.
3. Пользователь изменяет нужные поля.
4. Нажимает «Изменить».
5. Система валидирует данные.
6. Обновлённая задача сохраняется в хранилище.
7. Данные таблицы обновляются.

**Альтернативы:**

**A1: Ошибка в данных**
1. Пользователь выбирает некоррктную дату (дату в прошлом).
2. Система отображает сообщение об ошибке: «Дата выполнения не может быть в прошлом».
3. Пользователь исправляет данные и повторяет действие.

**Постусловие:**
1. Данные обновлены.
2. Интерфейс готов к следующему действию.

## Название варианта использования: Удаление задачи.

**Цель:** Удалить ненужную или устаревшую задачу.

**Актёры:** Администратор.

**Триггер:** Пользователь выбирает задачу для удаления.

**Предварительные условия:**
- открыто приложение;
- пользователь выбрал задачу в таблице.

**Основной поток выполнения:**
1. Пользователь выбирает запись в таблице.
2. Нажимает кнопку «Удалить».
3. Система удаляет запись из текущего хранилища.
4. Таблица обновляется.

**Альтернативы:**

**A1: Запись не выбрана:**
1. Пользователь нажимает «Удалить» без выбора строки;
2. Система показывает сообщение: «Выберите задачу для удаления».

**Постусловие:**
1. Задача удалён.
2. Интерфейс обновлён.

## Название варианта использования: Фильтрация задач.

**Цель:** Отобразить задачи, соответствующие введённым критериям поиска.

**Актёры:** Администратор, Исполнитель.

**Триггер:** Пользователь вводит текст в поле фильтрации.

**Предварительные условия:**
- приложение открыто;
- в таблице имеются данные.

**Основной поток выполнения:**
1. Пользователь вводит ключевые слова в поле фильтрации.
2. Система отбирает задачи по совпадению с названием и описанием.
3. Система отображает нужные записи.
4. При удалении текста фильтра отображаются все записи.

**Альтернативы:**
- отсутствуют.

**Постусловие:**
1. Отображаются только задачи, соответствующие фильтру;
2. При очистке фильтра — весь список.

## Название варианта использования: Сортировка задач.

**Цель:** Упорядочить задачи по приоритету, дате или категории.

**Актёры:** Администратор, Исполнитель.

**Триггер:** Пользователь выбирает параметр сортировки из выпадающего списка.

**Предварительные условия:**
- приложение запущено;
- в таблице есть записи;
- выпадающий список доступен.

**Основной поток выполнения:**
1. Пользователь открывает список сортировки.
2. Выбирает параметр сортировки и направление (по возрастанию/по убыванию).
3. Система применяет выбранный способ сортировки и обновляет таблицу.

**Альтернативы:**
- нет.

**Постусловие:**
Таблица отсортирована в соответствии с выбором пользователя.

## Название варианта использования: Ежедневное напоминание через Telegram.

**Цель:** Автоматически напомнить пользователю о задачах на текущий день.

**Актёры:** Наблюдатель.

**Триггер:** Планировщик запускает отправку сообщений в 08:00.

**Предварительные условия:**
- бот и приложение запущены;
- пользователь ранее активировал бота и передал chatId.

**Основной поток выполнения:**
1. Планировщик (Scheduler) запускает задачу в 08:00.
2. TelegramReminderBot запрашивает задачи со сроком на сегодня.
3. Если задачи есть — формирует список и отправляет сообщение.
4. Если задач нет — отправляется уведомление об отсутствии дел.

**Альтернативы:**

**A1: Нет подключения к интернету:**
1. Бот не может отправить сообщение;
2. Сообщение не отправляется, логируется ошибка.

**Постусловие:**
Пользователь получает список актуальных задач на текущий день.

## Название варианта использования: Ручной запрос задач через Telegram.

**Цель:** Получить список задач на текущий день по команде пользователя.

**Актёры:** Администратор, Исполнитель.

**Триггер:** Пользователь отправляет боту команду /tasks.

**Предварительные условия**
- бот и приложение запущены;
- пользователь ранее активировал бота и передал chatId.

**Основной поток выполнения:**
1. Пользователь отправляет сообщение / tasks.
2. Бот получает команду, находит chatId.
3. Выполняется поиск задач на текущую дату.
4. Бот отправляет их в сообщении с форматированием.

**Альтернативы:**
- Нет.

**Постусловие:**
Пользователь видит список задач в Telegram.

## Название варианта использования: Смена источника хранения данных.

**Цель:** Позволить пользователю выбрать, где будут храниться данные.

**Актёры:** Администратор, Исполнитель.

**Триггер:** Пользователь выбирает нужный источник данных из списка и нажимает «Выбрать».

**Предварительные условия:**
- все реализации DAO и их источники доступны;
- приложение работает, интерфейс активен.

**Основной поток выполнения:**
1. Пользователь открывает выпадающий список источников данных.
2. Выбирает один из вариантов: «PostgreSQL», «Excel», «H2».
3. Нажимает кнопку «Выбрать».
4. Система инициализирует соответствующий DAO.
5. Таблица обновляется в соответствии с выбранным хранилищем.

**Альтернативы:**

**A1: Ошибка подключения к источнику данных**
1. Подключение не удалось (например, нет интернета или неправильные параметры).
2. Система отображает сообщение об ошибке: «Не удалось подключиться к источнику».

**Постусловие:**
Программа работает с выбранным хранилищем, данные обновлены.

В результате была сформирована диаграмма Use-Case.

## Диаграмма Use-Case для написанных сценариев
![Диаграмма Use-Case для написанных сценариев](https://github.com/23yulia03/hometracker_kurs/blob/main/img/use-case.png)